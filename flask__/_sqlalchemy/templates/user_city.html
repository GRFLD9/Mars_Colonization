{% extends "base.html" %}

{% block head %}
    <script src="https://api-maps.yandex.ru/2.1/?apikey=dee718a6-a941-408b-9c5d-4c5aa779caa9&lang=ru_RU" type="text/javascript"></script>
    <style>
        #map {
            width: 100%;
            height: 500px;
            margin: 20px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .city-info {
            margin-bottom: 20px;
        }
    </style>
{% endblock %}

{% block content %}
<div class="container">
    <div class="city-info">
        <h2>{{ user.surname }} {{ user.name }}</h2>
        <h3>Родной город: {{ address }}</h3>
    </div>

    <div id="map"></div>

    <div class="text-center">
        <a href="/" class="btn btn-primary">На главную</a>
    </div>

    <script type="text/javascript">
        ymaps.ready(init);

        function init() {
            const map = new ymaps.Map("map", {
                center: [{{ coordinates.latitude }}, {{ coordinates.longitude }}],
                zoom: 12,
                controls: ['zoomControl', 'typeSelector']
            });

            // Добавляем метку
            const placemark = new ymaps.Placemark(
                [{{ coordinates.latitude }}, {{ coordinates.longitude }}],
                {
                    hintContent: '{{ address }}',
                    balloonContent: 'Родной город колониста'
                },
                {
                    preset: 'islands#redDotIcon'
                }
            );

            map.geoObjects.add(placemark);

            // Опционально: подстраиваем карту под метку
            map.setBounds(map.geoObjects.getBounds(), {
                checkZoomRange: true,
                zoomMargin: 50
            });
        }
    </script>
</div>
{% endblock %}